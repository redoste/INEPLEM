chntpw_ver="140201"
chntpw_uri="http://pogostick.net/~pnh/ntpasswd/chntpw-source-$chntpw_ver.zip"
chntpw_sha256="96e20905443e24cba2f21e51162df71dd993a1c02bfa12b1be2d0801a4ee2ccc"
chntpw_tar="downloads/chntpw-source-$chntpw_ver.zip"
chntpw_source="sources/chntpw-$chntpw_ver"

function chntpw_download(){
	echo "DOWNLOADING CHNTPW ...."
	rm $chntpw_tar 2>/dev/null
	rm -r $chntpw_source 2>/dev/null

	curl $chntpw_uri -o $chntpw_tar
	tar_sha=$(sha256sum $chntpw_tar | cut -d " " -f 1)
	if [ $tar_sha != $chntpw_sha256 ]; then
		echo "Invalid $chntpw_tar ! (sha256 mismatch"
		exit 1
	fi
	unzip $chntpw_tar -d sources/
	rm $chntpw_source/*.static 2>/dev/null
	echo "DOWNLOADING CHNTPW DONE"
}

function chntpw_build(){
	echo "BUILDING CHNTPW ...."
	cd $chntpw_source
	make clean
	make reged
	cd "$SCRIPT_FOLDER"
	echo "BUILDING CHNTPW DONE"
}

function chntpw_install(){
	echo "INSTALLING CHNTPW ...."
	mkdir -p rootfs/bin
	cp $chntpw_source/reged rootfs/bin/
	echo "INSTALLING CHNTPW DONE"
}
