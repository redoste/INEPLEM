busybox_ver="1.30.0"
busybox_uri="https://www.busybox.net/downloads/busybox-$busybox_ver.tar.bz2"
busybox_sha256="9553da068c0a30b1b8b72479908c1ba58672e2be7b535363a88de5e0f7bc04ce"
busybox_tar="downloads/busybox-$busybox_ver.tar.bz2"
busybox_source="sources/busybox-$busybox_ver"

function busybox_download(){
	echo "DOWNLOADING BUSYBOX ...."
	rm $busybox_tar 2>/dev/null
	rm -r $busybox_source 2>/dev/null

	curl $busybox_uri -o $busybox_tar
	tar_sha=$(sha256sum $busybox_tar | cut -d " " -f 1)
	if [ $tar_sha != $busybox_sha256 ]; then
		echo "Invalid $busybox_tar ! (sha256 mismatch)"
		exit 1
	fi
	tar -xf $busybox_tar -C sources/
	echo "DOWNLOADING BUSYBOX DONE"
}

function busybox_build(){
	echo "BUILDING BUSYBOX ...."
	cp config/busybox.config $busybox_source/.config
	cd $busybox_source
	make -j 4
	make install
	cd "$SCRIPT_FOLDER"
	echo "BUILDING BUSYBOX DONE"
}

function busybox_install(){
	echo "INSTALLING BUSYBOX ...."
	mkdir -p rootfs/bin/
	mkdir -p rootfs/dev/ rootfs/mnt/ rootfs/proc/ rootfs/sys/
	cp $busybox_source/_install/bin/busybox rootfs/bin/
	echo "INSTALLING BUSYBOX DONE"
}
